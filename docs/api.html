<!DOCTYPE HTML>
<html>
<!--
This document is considered public domain.
Please modify, copy, share as you like.
Correct or complete information isn't guaranteed.
 -->
<head>
<title>Blitwizard API documentation</title>    
<style type="text/css">
a[href] {
	color:#00f;
	text-decoration:none;
}
a[href]:hover {
	color:#00f;
	text-decoration:underline;
}
body,html {
	font-family:Arial,DejaVu Sans;
	font-size:1em;
	background-color:#fff;
	color:#000;
}
h1 {
	font-size:1.5em;
}
h2 {
	font-size:1.2em;
}
li h2 {
	background-color:#cee;
}
ul {
	list-style-type:none;
}
tr,td {
    vertical-align:top;
}
.parameters {
	list-style-type:disc;
}
.toc {
	list-style-type:disc;
}
.code {
	padding:1em;
	border:1px solid #000;
	font-family:monospace;
	white-space:pre;
}
</style>
<body>
<a name="0toc"><h1>0. Table of Contents</h1></a>
<ul class="toc">
<li><a href="#1introduction">1. Introduction</a></li>
<li><a href="#2summary">2. API summary and document structure</a></li>
<li><a href="#3blitwiz.font">3. <i>blitwiz.font</i> namespace</a></li>
<li><a href="#blitwiz.graphics">4. <i>blitwiz.graphics</i> namespace</a></li>
<li><a href="#blitwiz.net">5. <i>blitwiz.net</i> namespace</a></li>
<li><a href="#blitwiz.physics">6. <i>blitwiz.physics</i> namespace</a></li>
<li><a href="#blitwiz.sound">7. <i>blitwiz.sound</i> namespace</a></li>
<li><a href="#blitwiz.time">8. <i>blitwiz.time</i> namespace</a></li>
<li><a href="#9blitwiz.on_*">9. Event callbacks</a></li>
<li><a href="#10os">10. <i>os</i> standard namespace extension</a></li>
<li><a href="#string">11. <i>string</i> standard namespace extension</a></li>
</ul>
<a name="1introduction"><h1>1. Introduction</h1></a>
<p>This document describes the blitwizard Lua api with all provided functions.
Since blitwizard is intended for use with Lua 5 (which it includes),
those are mainly the functions you will use to program your games.</p>
<p>Event callbacks are also listed in the <a href="#7blitwiz.on_*">event section</a>.</p>
<p>If this document refers to namespaces, this actually means the Lua tables in
the global space that hold sub functions and variables conveniently packed into
common modules, e.g. the string table or the os table of the standard lib.</p>
<a name="2summary"><h1>2. API summary and document structure</h1></a>
<p>
Blitwizard mainly comes with an own blitwiz namespace, but also extends the Lua 5
standard library which it contains. The Lua 5 standard functions are <b>not</b> described
here but nevertheless important for using Lua, so
<a href="http://www.lua.org/manual/5.2/manual.html#6">take a look at Lua's standard lib reference</a>
if you aren't familiar with them.</p>
<p>The blitwizard extensions to the standard library however, consisting of additional
functions added to the Lua 5 standard namespaces,
e.g. <a href="#string">additional string functions</a>, are described in this document.</p>
<p>All functions listed in this document are listed with their names, parameters and return value,
whereas a parameter type and return value type
is specified.
Of course Lua allows you to specify variables of any type as parameter,
but most functions will error if you submit an unfitting type.
The types are specified
in brackets behind the parameters like this: <i>(number)</i>. The return value is
described in the more lengthy description which
follows each listed function.</p>
<p>Those types refer to standard Lua 5 variable types: <i>number, string, boolean, function, nil</i></p>
<p>Those types are special blitwizard types which are introduced by blitwizard functions:
</p>
<ul>
<li>
<p><i><a name="network_stream">network stream</a></i> &mdash; represents a network stream. You can send data over a network stream, change its settings or close it.
</p>
<p>
Scope: If you no longer reference your network stream, it will disappear automatically. However, it will only disappear after some time (when garbage collected) and up to that point, it will continue to hang around (and the network connection to your target will remain open for that time). Therefore, it is recommended you explicitely close it with <a href="#blitwiz.net.close">blitwiz.net.close</a>.
</p>
</li>
<li>
<p><i><a name="physics_object">physics object</a></i> &mdash; represents a physics object. Allows you to retrieve its position/rotation and apply new forces.
</p>
<p>
Scope: If you no longer reference your physics object, it will disappear automatically. However, it will only disappear after some time (when garbage collected) and up to that point, it will continue to hang around (and other physics objects will still be able to collide with it for that time). Therefore, it is recommended you explicitely destroy physics objects with <a href="#blitwiz.physics.destroyObject">blitwiz.physics.destroyObject</a>.
</p>
</li>
<li>
<p>
<i><a name="sound_handle">sound handle</a></i> &mdash; specifies a played sound. You can use the handle to check whether it still plays or whether it stopped and it allows you to modify some things afterwards (e.g. abort the sound).
If you play the same sound file many times, you will always get different sound handles for each separately played sound.
</p>
<p>
Scope: If you no longer have any reference to a sound handle, the sound is unaffected - it continues to play until it ends regularly. You also don't need to destroy the sound handle in any way when the sound has finished playing.
</p>
</li>
</ul>
<p>The Lua 5 of blitwizard is mostly compiled with standard settings, e.g. numbers
being double 64bit floating point numbers. Null bytes in strings are generally not
supported by functions in the blitwiz namespace (those will cut the string off at the
first null byte), while all extension functions put into the standard namespaces (like
the string functions) can deal with null bytes similar to Lua's own internal string
functions.</p>
<a name="blitwiz.graphics"><h1>4. <i>blitwiz.graphics</i> namespace</h1></a>
<ul>

<li><h2><a name="blitwiz.graphics.drawImage">blitwiz.graphics.drawImage</a>(filename <i>(string)</i>, settings <i>(table)</i>)</h2>
<p>
Draw a fully loaded image (see <a href="#blitwiz.graphics.loadImage">blitwiz.graphics.loadImage</a> and <a href="#blitwiz.on_image">on_image</a>).
Throws an error if the image isn't fully loaded.
Don't use this call anywhere else than from inside <a href="#blitwiz.on_draw">on_draw</a>.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>filename <i>(string)</i> &mdash; specify the filename/path of the loaded image</li>
<li>settings <i>(table)</i> &mdash; a table with key-&gt;value pairs containing the settings, with the settings being those (all settings are optional):
<table style="border:1px solid black">
    <tr>
        <td><u>Settings name</u></td><td><u>Value type</u></td><td><u>Explanation</u></td>
    </tr>
    <tr>
        <td>
        "x"
        </td>
        <td>number</td>
        <td>horizontal position in pixels (0 is left, positive goes right) on the screen, negative coordinates are also allowed (image will be blitted partly or fully moved out of the screen)</td>
    </tr>
    <tr>
        <td>
        "y"
        </td>
        <td>number</td>
        <td>vertical position in pixels (0 is top, positive goes downwards) on the screen, negative coordinates possible (see above)</td>
    </tr>
    <tr>
        <td>"alpha"</td>
        <td>number</td>
        <td>alpha opacity in the range 0..1, with 0 being completely invisible and 1 fully opaque, and e.g. 0.5 half-transparent. Default is 1</td>
    </tr>
    <tr>
        <td>"cutx"</td>
        <td>number</td>
        <td>cut off the given amount of pixels from the left border of the image before drawing it. Use this to draw only a smaller part of an image. Default is 0 (no cutoff)</td>
    </tr>
    <tr>
        <td>"cuty"</td>
        <td>number</td>
        <td>cut off the given amount of pixels from the top border of the image before drawing it. Default is 0 (no cutoff)</td>
    </tr>
    <tr>
        <td>"cutwidth"</td>
        <td>number</td>
        <td>cut the image (after applying cutx and cuty) to the given maximum width before drawing it. Default is infinite (no cutoff)</td>
    </tr>
    <tr>
        <td>"cutheight"</td>
        <td>number</td>
        <td>cut the image (after applying cutx and cuty) to the given maximum height before drawing it. Default is infinite (no cutoff)</td>
    </tr>
    <tr>
        <td>"scalex"</td>
        <td>number</td>
        <td>scale the final resulting image or image part (after cut was applied) horizontally by the given factor. Default is 1 (normal horizontal size)</td>
    </tr>
    <tr>
        <td>"scaley"</td>
        <td>number</td>
        <td>scale the final resulting image or image part vertically by the given factor. Default is 1 (normal vertical size)</td>
    </tr>
    <tr>
        <td>"rotationangle"</td>
        <td>number</td>
        <td>rotate the image (after applying cutting) around the given rotation angle in degree. 0 means not rotated, 90 means rotated 90&deg; clockwise around the center, -90 counter-clockwise around the center, etc. Default is 0 (no rotation)</td>
    </tr>
    <tr>
        <td>"rotationcenterx"</td>
        <td>number</td>
        <td>the center point around which the image should be rotated. 0 is the left border of the image, positive values go to the right. Scaling is ignored for this (the image is rotated first, then scaled up). Default is image center (image width / 2)</td>
    </tr>
    <tr>
        <td>"rotationcentery"</td>
        <td>number</td>
        <td>the center point around which the image should be rotated. 0 is the top border of the image, positive values go down. Default is image center (image height / 2)</td>
    </tr>
    <tr>    
        <td>"flipped"</td>
        <td>boolean</td>
        <td>flip the image horizontally. This is applied before rotation and scaling and clipping is processed</td>
    </tr>
    <tr>
        <td>"red"</td>
        <td>number</td>
        <td>how much red the image should have when drawn. If you supply 0 here, all red will be eliminated (like a color filter). 1 will use the original red value of the image. If you set e.g. blue, green both to 0 and red to 1, the image will be tinted in red</td>
    </tr>
    <tr>
        <td>"green"</td>
        <td>number</td>
        <td>green tint, see red tint explanation</td>
    </tr>
    <tr>
        <td>"blue"</td>
        <td>number</td>
        <td>blue tint, see red tint explanation</td>
    </tr>
</table>
</ul>
<p>
Return value: <i>nil</i> &mdash; none
</p>
<p>
Examples:
<div class="code">-- Draw an image at position 5,5 into the currently opened output window
blitwiz.graphics.drawImage("mypicture.png", {x=5, y=5})

-- Draw the image again moved to the right with only 75% visibility (slightly transparent):
blitwiz.graphics.drawImage("mypicture.png", {x=150, y=5, alpha=0.75})

-- Draw the image again, now rotated 45&deg; clockwise around its center
blitwiz.graphics.drawImage("mypicture.png", {x=150, y=5, alpha=0.75, rotationangle=45)

</div>
<p>
</li>

<li><h2><a name="blitwiz.graphics.drawRectangle">blitwiz.graphics.drawRectangle</a>(x <i>(number)</i>, y <i>(number)</i>, width <i>(number)</i>, height <i>(number)</i>, red <i>(number)</i>, green <i>(number)</i>, blue <i>(number)</i>, alpha <i>(number)</i>)</h2>
<p>
Draw a simple colored filled rectangle at the given coordinates with the given dimensions.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>x <i>(number)</i> &mdash; x drawing position</li>
<li>y <i>(number)</i> &mdash; y drawing position</li>
<li>width <i>(number)</i> &mdash; rectangle width</li>
<li>height <i>(number)</i> &mdash; rectangle height</li>
<li>red <i>(number)</i> &mdash; red color value of the rectangle's color (in a range from 0 to 1)</li>
<li>blue <i>(number)</i> &mdash; blue color value of the rectangle's color (in a range from 0 to 1)</li>
<li>green <i>(number)</i> &mdash; green color value of the rectangle's color (i n a range from 0 to 1)</li>
<li>alpha <i>(number, optional)</i> &mdash; alpha opaque value for the rectangle, which is a value between 0 (meaning invisible) and 1 (for fully visible/solid). Default is 1</li>
</ul>
<p>
Example:
</p>
<div class="code">-- Fill whole screen with a blue/greenish rectangle
local w,h = blitwiz.graphics.getWindowSize()
blitwiz.graphics.drawRectangle(0, 0, w, h, 0, 0.5, 1)
</div>
</li>

<li><h2><a name="blitwiz.graphics.getDesktopDisplayMode">blitwiz.graphics.getDesktopDisplayMode()</a></h2></li>
<p>
Get the current display mode of the desktop. Simply returns the fullscreen video mode if you have a fullscreen window opened.
</p>
<p>Parameters: None</p>
<p>Return values: width <i>(number)</i>, height <i>(number)</i></p>
<p>Example:
</p>
<div class="code">-- Obtain the desktop display mode
local w,h = blitwiz.graphics.getDesktopDisplayMode()
print("Current display mode of the desktop: " .. w .. "x" .. h)
</div>
</li>

<li><h2><a name="blitwiz.graphics.getDisplayModes">blitwiz.graphics.getDisplayModes()</a></h2></li>
<p>
Get a table of display modes which are supported for fullscreen windows.
</p>
<p>Parameters: None</p>
<p>Return values: table containing display modes (each display mode is itself a table containing two values representing width and height in pixels), the one that is believed to be the native screen resolution will come first</p>
<p>Example:
</p>
<div class="code">-- Print out all available screen resolutions
local displaymodes = blitwiz.graphics.getDisplayModes()
for index,displaymode in ipairs(displaymodes) do
	print("Display mode: " .. tostring(displaymode[1]) .. "x" .. tostring(displaymode[2]))
end
</div>
</li>

<li><h2><a name="blitwiz.graphics.getImageSize">blitwiz.graphics.getImageSize</a>(filename <i>(string)</i>)</h2>
<p>
Returns the size of a fully loaded image (see <a href="#blitwiz.graphics.loadImage">blitwiz.graphics.loadImage</a> and <a href="#blitwiz.on_image">on_image</a>).
Throws an error if the image isn't fully loaded.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>filename <i>(string)</i> &mdash; specify the filename/path of the loaded image</li>
</ul>
<p>
Return values: image width <i>(number)</i>, image height <i>(number)</i>
</p>
<p>
Example:
</p>
<div class="code">-- Output the size of an image
local w,h = blitwiz.graphics.getImageSize("mypicture.png")
print("The size of mypicture.png is: " .. tostring(w) .. "," .. tostring(h))
</div>
</li>

<li><h2><a name="blitwiz.graphics.getRendererName">blitwiz.graphics.getRendererName</a>()</h2>
<p>
Get the name of the currently used graphics renderer or nil if no window is open.
</p>
<p>Parameters: None</p>
<p>Return values: renderer name <i>(string)</i> or nil. Check the <a href="#renderers">list of supported renderers</a></p>
</li>

<li><h2><a name="blitwiz.graphics.getWindowSize">blitwiz.graphics.getWindowSize</a>()</h2>
<p>
Returns the size of the currently open window (see <a href="#blitwiz.graphics.setWindow">blitwiz.graphics.setWindow</a>).
Throws an error if no window is open.
</p>
<p>
Parameters: None
</p>
<p>
Return values: window width <i>(number)</i>, window height <i>(number)</i>
</p>
</li>

<li><h2><a name="blitwiz.graphcis.isImageLoaded">blitwiz.graphics.isImageLoaded</a>(filename <i>(string)</i>)</h2>
<p>
Check whether an image is fully loaded and available or not.
If the image has been loaded through <a href="#blitwiz.graphics.loadImage">
blitwiz.graphics.loadImage</a> or through <a href="#blitwiz.graphics.loadImageAsync">
blitwiz.graphics.loadImageAsync</a> (with the async loading being complete),
the function will return true.
</p>
<p>In all other cases (e.g. also when the image is still being loaded through
<a href="#blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>)
the function will return false.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>filename <i>(string)</i> &mdash; specify the filename/path of the image</li>
</ul>
<p>
Return value: image presence state as described above <i>(boolean)</i>
</p>
</li>

<li><h2><a name="blitwiz.graphics.loadImage">blitwiz.graphics.loadImage</a>(filename <i>(string)</i>)</h2>
<p>
Prompt an image file for loading for use in drawing operations and wait for it to be loaded.
This needs to be done
for any image you want to use with e.g. <a href="#blitwiz.graphics.drawImage">blitwiz.graphics.drawImage</a>
later.
Throws an error when image loading fails.
</p>
<p>Currently supported file formats: PNG (.png)</p>
<p>Calling <a href="#blitwiz.graphics.loadImage">blitwiz.graphics.loadImage</a>
when the image has been loaded already or when loading is already in progress through a call
to <a href="#blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>
will lead to an error being thrown.
<p>
Parameters:
</p>
<ul class="parameters">
<li>filename <i>(string)</i> &mdash; specify the filename/path of the image</li>
</ul>
<p>
Return value: <i>nil</i> &mdash; none
</p>
<p>
Example:
</p>
<div class="code">-- Load an image:
blitwiz.graphics.loadImage("mypicture.png")

-- You can now use the image instantly for drawing with <a href="#blitwiz.graphics.drawImage">blitwiz.graphis.drawImage</a>
</div>
</li>


<li><h2><a name="blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>(filename <i>(string)</i>)</h2>
<p>
Prompt an image file for loading for use in drawing operations but don't wait for it to finish loading (unlike <a href="#blitwiz.graphics.loadImage">blitwiz.graphic.loadImage</a>).
</p>
<p>
Image loading is done in the
background while the script execution and engine operation continues fully, and as soon as the image
loading process has finished, you'll get an <a href="#blitwiz.on_image">on_image</a> event call.
<p>
<p>Do not use any image for drawing before you got the on_image event with reported success! It will
result in an error being thrown.</p>
<p>Calling <a href="#blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>
when the image is already being loaded simply does nothing. As soon as an
<a href="#blitwiz.on_image">on_image</a> event reports success, any further
calls attempting to load such an image will result in an error that the image
is already loaded.
If <a href="#blitwiz.on_image">on_image</a> reported failure, you can retry
<a href="#blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>
(or <a href="#blitwiz.graphics.loadImage">blitwiz.graphics.loadImage</a>) safely.
<p>
Parameters:
</p>
<ul class="parameters">
<li>filename <i>(string)</i> &mdash; specify the filename/path of the image</li>
</ul>
<p>
Return value: <i>nil</i> &mdash; none
</p>
<p>
Example:
</p>
<div class="code">-- Load an image:
blitwiz.graphics.loadImageAsync("mypicture.png")

-- Here at this point, the image is NOT available for use yet, so drawing and all that will fail.
-- We need to wait for an <a href="#blitwiz.on_image">on_image</a> event first!
</div>
</li>

<!--<li><h2><a name="blitwiz.graphics.rayCast">blitwiz.graphics.rayCast</a>(raycast sector <a href="#raycast_sector"><i>(raycast sector)</i></a>, draw window x <i>(number)</i>, draw window y <i>(number)</i>, draw window width <i>(number)</i>, draw window height <i>(number)</i>, camera x<i>(number)</i>, camera y<i>(number)</i>, camera z <i>(number)</i>, camera horizontal angle <i>(number)</i>, camera vertical shift <i>(number)</i>, camera fov angle <i>(number)</i>, camera aspect ratio <i>(number)</i>)</h2>
<p><i>Available in Blitwizard 0.4 or newer.</i> Draw the raycasting sector inside the given draw window on the screen with the given camera info. This will lead to other sectors being drawn when the sector has callbacks for portals to other sectors specified (see <a href="#blitwiz.graphics.setRayCastSectorPortal">blitwiz.graphics.setRayCastSectorPortal</a>).
</p>
</li>

<li><h2><a name="blitwiz.graphics.rayCastTest">blitwiz.graphics.rayCastTest</a>(raycast sector <a href="#raycast_sector"><i>(raycast sector)</i></a>, ray start x <i>(number)</i>, ray start y<i>(number)</i>, ray start z <i>(number)</i>, ray end x<i>(number)</i>, ray end y<i>(number)</i>, ray end z<i>(number)</i>)</h2>
<p><i>Available in Blitwizard 0.4 or newer.</i> This function works similar to <a href="#blitwiz.graphics.rayCast">blitwiz.graphics.rayCast</a> in starting in a specified sector and then walking through others as needed by calling the portal callbacks, but it doesn't do that to draw the world on screen, instead it checks for collisions.</p>
<p>When a collision is found, the collision point is returned with a sector reference, the 3d world position in the sector, the sector surface (a sector wall or ceiling/floor) that was hit and a surface normal vector of the collided surface. See return value for details.
</p>
</li>

<li><h2><a name="blitwiz.graphics.setRayCastPortal">blitwiz.graphics.setRayCastPortal</a>(raycast sector <a href="#raycast_sector"><i>(raycast sector)</i></a>, surface id <i>(number)</i>, portal callback <i>(function(sector))</i>)</h2>
<p><i>Available in Blitwizard 0.4 or newer.</i> Set portals to a surface (a wall or the ceiling or the floor) by specifying a function which returns the new sector you end up in.
</p>
</li>-->

<li><h2><a name="blitwiz.graphics.setWindow">blitwiz.graphics.setWindow</a>(width <i>(number)</i>, height <i>(number)</i>, title<i>(string)</i>, fullscreen<i>(boolean)</i>, renderer<i>(string)</i>)</h2>
<p>
Open a new graphics output window, or change the settings for a currently opened
window in case there is one already opened.
You can also <i>close</i> the window by passing no parameters.
</p>
<p>
If there is a problem opening a window,
an error will be triggered. Common errors that might occur:
</p>
<ul style="list-style-type:disc">
<li>
Using a resolution not listed in <a href="#blitwiz.graphics.getDisplayModes">blitwiz.graphics.getDisplayModes</a> for fullscreen will throw an error. Pick a resolution from that list for a fullscreen window to avoid this (or simply try your preferred first, then one that should be supported - see example code below).
</li>
<li>
Using windowed mode isn't supported on some platforms supported by blitwizard (e.g. Android phone) and will throw an error. Catch it and retry in fullscreen mode (with a <a href="#blitwiz.graphics.getDisplayModes">getDisplayModes</a> resolution) to handle such platforms properly.
</li>
<li>
Using some renderers that blitwizard considered to be available (blitwizard will only allow you to use a renderer it thinks is available and will otherwise simply use the default) can sometimes result in an error if it turns out the renderer is not working properly on the given system. You should always try the renderer "software" as a slower but safe fallback in such a case.
</li>
</ul>
<p>
Texture loading is possible without any open window, and textures remain
available even if you call setWindow again or setWindow fails.
As soon as setWindow succeeds
in creating or changing a window, you will be able to use all previously loaded
textures instantly
without any further actions required.
</p>
<p>
Please note on a renderer change, this function call can take a few seconds of time
which it needs for transferring all the textures to the new renderer - it will block
and only return as soon as the renderer change is complete.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>width <i>(number)</i> &mdash; specify the width (in pixels) of the output window</li>
<li>height <i>(number)</i> &mdash; specify the height (in pixels) of the output window</li>
<li>title <i>(string, optional)</i> &mdash; specify a window title for the title bar</li>
<li>fullscreen <i>(boolean, optional)</i> &mdash; specify if the window should be fullscreen (true) or not (false) - default is false. For fullscreen windows, width and height need to be listed in the output of <a href="#blitwiz.graphics.getDisplayModes">blitwiz.graphics.getDisplayModes()</a></li>
<li>renderer <i>string</i> &mdash; specify a preferred renderer. this specifies the
backend blitwizard will use to output the graphics. A <a href="#renderers">list of available renderers</a> and which one is chosen as default on each platform can be found <a href="#renderers">below</a>
<p>Generally you shouldn't force anything here, except if you want to allow the user to specify a
renderer explicitely or when setWindow fails with the default choice (which is different depending
on various things like the platform).
</p>
<p><a name="renderers">Supported renderers:</a>
</p>
<ul style="list-style-type:disc">
<li><b>software</b> - available on Windows, Mac, Linux, all other Unix-like Systems like FreeBSD, OppenBSD,... <i>Note: Slow, but always works on those platforms - allow the user to pick this one in case the other renderers don't work correctly.</i></li>
<li><b>opengl</b> - available on Windows, Mac (default), Linux (default), Android (default), all other Unix-like systems like FreeBSD, OpenBSD,... (default). <i>Note: Only choice on Android. Windows often supports this one badly</i></li>
<li><b>direct3d</b> - available on Windows (default). <i>Note: safest choice on Windows (apart from the slow software renderer), but not available anywhere else</i>
</li>
</ul>
<p>
Call <a href="#os.sysname">os.sysname</a> to get the platform name, so you can decide on which renderers you offer to the user - mainly, you shouldn't offer "software" on Android and "direct3d" for non-Windows platforms.
</p>
</li>
</ul>
<p>
Example:
</p>
<div class="code">-- Attempt to run in fullscreen and open a window if that doesn't work.
-- Fallback to unusual resolutions for mobile device support

-- Yes, it is long. If you only care for desktop platforms with modern graphics cards,
-- you might just use a simple blitwiz.graphics.setWindow(commonresolution_x, commonresolution_y, "My Game", true)
-- and it will probably work fine for you.

-- However, if you want your game to run on mobile devices and such without any changes (and desktop computers with
-- outdated/odd video drivers), this lengthy procedure is what you want.

local game_title = "My Game"

local function tryopenwindowfullscreen(renderer, adapt_resolution)
	if adapt_resolution == false then
		-- Open a fullscreen window in the preferred resolution
		blitwiz.graphics.setWindow(640, 480, game_title, true, renderer)
	else
		-- Open a fullscreen window at any resolution
		resolution = blitwiz.graphics.getDisplayModes()[1]
		blitwiz.graphics.setWindow(resolution[1], resolution[2], game_title, true, renderer)
	end
end

local function tryopenwindow(renderer)
	-- Open a normal window in the preferred size
	blitwiz.graphics.setWindow(640, 480, game_title, true, renderer)
end

local function initialisewindow()
	-- Attempt fullscreen first at desired resolution
	local success = pcall(tryopenwindowfullscreen, nil, false)
	if success == true then
		return
	end

	-- Test fallback to windowed mode
	success = pcall(tryopenwindow, nil)
	if success == true then
		return
	end

	-- Attempt software rendering in fullscreen at desired resolution
	success = pcall(tryopenwindowfullscreen, "software", false)
	if success == true then
		return
	end

	-- Attempt to use just any resolution on fullscreen
	success = pcall(tryopenwindowfullscreen, nil, true)
	if success == true then
		-- Check if the resolution is big enough for your game,
		-- assuming that your game can adapt to pretty much any resolution
		-- (which you should ensure for maximum compatibility) but still
		-- has an absolute minimum resolution where the interface will
		-- still display properly.

		-- You should do this for mobile devices which might have tiny
		-- resolutions to make sure your game rather quits with a sane
		-- error than running in an unplayable state when the resolution
		-- is just too tiny.
		
		if blitwiz.graphics.getWindowSize()[1] &lt; 400 or -- put numbers fitting for your game here
		blitwiz.graphics.getWindowSize()[2] &lt; 300 then
			error "Maximum display resolution is too small for this game"
		end
		return true
	end
		
	-- Sadly, this device does not seem to provide anything usable for us
	error "Failed to open graphics output"
end
</div>
</li>

</ul>
<a name="blitwiz.net"><h1>5. <i>blitwiz.net</i> namespace</h1><a>
<p>
This namespace offers lowlevel networking functionality. Please note that blitwizard also has easy-to-use <b>HTTP</b> (website access) and <b>IRC</b> (a realtime text chat protocol) support. Read <a href="https://github.com/JonasT/Blitwizard/blob/master/templates/http/http.lua">http.lua</a> and <a href="https://github.com/JonasT/Blitwizard/blob/master/templates/irc/irc.lua">irc.lua</a> for documentation, or take a look at those examples:
</p>
<p>
<div class="code">-- EXAMPLE FOR HTTP/IRC
    
-- Open a console for output with the print() function
os.openConsole()

-- Fetch a document using http
blitwiz.net.http.get("http://www.blitwizard.de/doc-files/Ship-your-game.txt",
    function(data)
        if data == nil then
            print("Failed to fetch the document (network error).")
        else
            print("Document arrived. HTTP response code: " .. data.response_code)
            print("HTTP response headers: " .. data.headers .. "\n")
            print("Document content: " .. data.content)
        end
    end
) -- end of blitwiz.net.http.get

-- Connect to an IRC server, join a channel and say something
math.randomseed(os.time()) -- initialise randomness for math.random()
blitwiz.net.irc.open("irc.eloxoph.de", 6667, "blitwiz" .. math.ceil(1 + math.random() * 999),
    function(server, event, ...)
        args = {...}
        if event == "connect" then
            -- We are connected to the server. Join the channel:
            blitwiz.net.irc.channelJoin(server, "#test")
        end
        if event == "join" then
            -- Someone joined a channel
            if string.lower(args[2]) == string.lower(blitwiz.net.irc.getNick(server)) then
                -- We joined a channel! Is it #test?
                if string.lower(args[1]) == "#test" then
                    -- We joined #test as intended. Say something:
                    blitwiz.net.irc.channelMessage(server, "#test", "Hello from blitwizard!")

                    -- Then leave the server again:
                    blitwiz.net.irc.quit(server, "Goodbye, test complete!")
                end
            else
                -- Someone else (not ourselves) joined a channel.
            end
        end
    end
) -- end of blitwiz.net.irc.open

</div>
<p>If you do not wish to use IRC/HTTP but something else or your own custom protocol, then read on (you should probably start with <a href="#blitwiz.net.open">blitwiz.net.open</a>).</p>
<p>Information for advanced users: blitwiz.net is based on TCP networking (but allows low delay networking with TCP_NODELAY, see lowdelay option below) and supports both IPv6/IPv4. SSL support is planned but not implemented yet.</p>
<ul>

<li><h2><a name="blitwiz.net.close">blitwiz.net.close(stream <a href="#network_stream"><i>(network stream)</i></a>)</a></h2>
<p>Close a network stream which you have previously opened with <a href="#blitwiz.net.open">blitwiz.net.open</a>. Please note you cannot close network streams for which the close callback was already triggered! However, waiting for the open callback to happen before closing is not necessary.
</p>
<p>All send data in the stream's send queue will still get sent, so doing <a href="#blitwiz.net.send">blitwiz.net.send</a>(stream, "a lot of data......") followed instantly by <a href="#blitwiz.net.close">blitwiz.net.close</a>() is safe and won't discard anything which hasn't been transmitted yet.</p>
<p>
Parameters: 
</p>
<ul class="parameters">
<li>stream to be closed <a href="#network_stream"><i>(network stream)</i></a> &mdash; the network stream which should be closed</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.net.open">blitwiz.net.open(settings <i>(table)</i>, open callback <i>(function(stream))</i>, read callback <i>(function(stream, data))</i>, close callback <i>(function(stream))</i>)</a></h2>
<p>Open a network stream with the given settings and callbacks. The callbacks will inform you about when the stream is opened, closed and when data arrived.</p>
<p>If you don't keep a Lua reference to the stream (which is returned by this function), the connection will get auto-closed and garbage collected when no data arrives for a while (and when nothing remains to be sent).</p>
<p>
Parameters: 
</p>
<ul class="parameters">
<li>settings <i>(table)</i></a> &mdash; a settings table, filled with key-&gt;value pairs that specify some of the following available settings (please note server/port are <b>required</b>, all other settings are optional):
<table style="border:1px solid black">
    <tr>
        <td><u>Settings name</u></td><td><u>Value type</u></td><td><u>Explanation</u></td>
    </tr>
    <tr>
        <td>
        "server"
        </td>
        <td>string</td>
        <td>the server host name or ip address to which you want to open a network stream</td>
    </tr>
    <tr>
        <td>
        "port"
        </td>
        <td>number</td>
        <td>the network port of the server to which you want to connect</td>
    </tr>
    <tr style="vertical-align:top">
        <td>
        "linebuffered"
        </td>
        <td>boolean</td>
        <td>this setting controls whether you get the received data as soon as it arrives in whatever chunk it arrives (false), or whether you want to get only neat, complete and properly line break separated lines (true). The latter setting will cause incomplete lines to be held back until the full line arrived, while the former will instantly deliver you all data, even when incomplete. The default is false (no line buffering)</td>
    </tr>
    <tr style="vertical-align:top">
        <td>
        "lowdelay"
        </td>
        <td>boolean</td>
        <td>this option allows you to enable faster sending on your network stream, cutting down the time until the network data will get sent out and eventually arrive at its target. This only affects the delay, NOT the overall network speed/bandwidth!<br><br>Actually, this option can cause severely <b>degraded</b> stream bandwidth, so don't use when you send a lot of data! This option is *only* useful when you send data that is vital to arrive very soon and where the small win on delay time is worth the downsides, e.g. player position data in a very fast-paced networking game.<br><br>Therefore, <b>DO NOT USE</b> this for data that doesn't need to have an ultra low arrival delay.<br><br>If you have both data that needs to arrive with ultra low delay and "normal" data, it is recommended you open two network streams and enable lowdelay only on one of the two streams, and use it for the low delay data purely</td>
    </tr>
</table>
</li>
<li>open callback <i>(function(stream), optional)</i> &mdash; a callback function that will be called when the stream has been successfully opened. As first and only parameter, the stream object <a href="#network_stream"><i>(network stream)</i></a> will be passed. As soon as a stream is opened, you can use <a href="#blitwiz.net.send">blitwiz.net.send</a> on it.</li>
<li>read callback <i>(function(stream, data), optional)</i> &mdash; a callback function that will be called when the stream has been previously opened at some point, and when data has arrived (sent by whatever you opened that stream to). The first parameter will be the stream object, the second will be the data <i>(string)</i> that arrived.</li>
<li>close callback <i>(function(stream), optional)</i> &mdash; a callback function that will be called when your stream was closed (or failed to open right from the start). It will be both triggered by a stream close caused by your stream target, and by a stream close triggered by yourself through <a href="#blitwiz.net.close">blitwiz.net.close</a>. The first parameter will be the now closed stream object.</li>
</ul>
<p>
Return value: newly opened network stream <a href="#network stream"><i>(network stream)</i></a>
</p>
<p>
Example:
</p>
<div class="code">-- Open a console for reading the console output from print():
os.openConsole()

-- Open a connection to www.blitwizard.de at port 80:
<a href="#blitwiz.net.open">blitwiz.net.open</a>({server="www.blitwizard.de", port=80, linebuffered=true},
    function(stream) -- open callback
        -- as soon as the stream is open, send a http request
        <a href="#blitwiz.net.send">blitwiz.net.send</a>(stream, "GET / HTTP/1.0\nHost: www.blitwizard.de\n\n")
    end,
    function(stream, data) -- read callback
        -- when a response line arrives, print it to the console:
        print("Data arrived: " .. data)
    end,
    function(stream) -- close callback
        print("Connection is now closed!")
    end
)
</div>
</li>

<li><h2><a name="blitwiz.net.send">blitwiz.net.send(stream <a href="#network_stream"><i>(network stream)</i></a>, data <i>(string)</i>)</a></h2>
<p>Send data over the given network stream (the open event on the network stream must have been triggered for this to work).
</p>
<p>
Parameters:
</p>
<ul class="parameters">
    <li>stream <a href="#network_stream"><i>(network stream)</i></a> &mdash; the network stream over which you want to send data</li>
    <li>data <i>(string)</i> &mdash; the data you want to send</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.net.server">blitwiz.net.server(port <i>(number)</i>, connection callback <i>(function(server, stream))</i>)</a></h2>
<p>Open a server listener on the given network port. The callback will be executed once a new client connection occurs, and will be passed the server (which is simply the port number) as first argument and the new client's network stream as second argument.</p>
<p>Please note the network stream you get handed over has no open/read/close-callbacks set - you will want to use <a href="#blitwiz.net.set">blitwiz.net.set</a> to set a read and close callback (connect is useless since when you get the network stream, it is already connected as a client to you).</p>
<p>To close a server, use blitwiz.net.close() on the server port.
</p>
<p>blitwiz.net.server throws an error when the server can't be opened (e.g. another server listener might be already using and blocking the same port).
</p>
<p>
Parameters:
</p>
<ul class="parameters">
    <li>port <i>(number)</i> &mdash; the network port you want the server to listen at</li>
    <li>connection callback <i>(function(server, stream))</i> &mdash; the callback function which handles the new connections</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.net.set">blitwiz.net.set(stream <a href="#network_stream"><i>(network stream)</i></a>, settings <i>(table)</i>, open callback <i>(function(stream))</i>, read callback <i>(function(stream, data))</i>, close callback <i>(function(stream))</i>)</a></h2>
<p>Set new, different settings and new callbacks to an existing network stream. Settings and callbacks are as described at <a href="#blitwiz.net.open">blitwiz.net.open</a>. If you omit a setting or a callback, it will remain unchanged.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>stream <a href="#network_stream"><i>(network stream)</i></a> &mdash; the network stream for which you want to change the settings and/or the callbacks</li>
<li>settings <i>(table)</i> &mdash; the stream settings, see <a href="#blitwiz.net.open">blitwiz.net.open</a></li>
<li>open callback <i>(function(stream))</i> &mdash; open callback, see <a href="#blitwiz.net.open">blitwiz.net.open</a></li>
<li>read callback <i>(function(stream, read))</i> &mdash; read callback</li>
<li>close callback <i>(function(stream,))</i> &mdash; close callback</li>
</ul>
<p>
Return value: None
</p>
</li>

</ul>
<a name="blitwiz.physics"><h1>6. <i>blitwiz.physics</i> namespace</h1></a>
<p>This namespace offers physics engine functionality (for 2D space, so objects with a two coordinate position and rotation moving and colliding on a 2D plane). For that, it uses <a href="#physics_object">physics objects</a>. Please note that a &ldquo;physics object&rdquo; is nothing you can see. You will need to draw an image at its position yourself if you want to actually see it in your game world. You can also not move objects directly (except <a href="#blitwiz.physics.warp">warping</a> which you should use as rarely as possible) - they will move on their own according to their mass, how they collide with each other etc. You can give them "pushes" though by using <a href="#blitwiz.physics.impulse">blitwiz.physics.impulse</a>.</p>
<p><b>Physics are complicated. Take a look at the examples to get an idea for it, especially the "Moving character" example if you simply want to make a character that walks around in a level.</b></p>
<p>
The physics use their own <b>physics units</b>. Do NOT use pixels here! Instead, think of how long a meter would roughly be in your game in pixels, and then scale all pixels accordingly into meter units before you pass them to the physics. Why? Physics operate best in certain value ranges:
</p>
<p>
The best size for your moving physics objects is between 0.1 and 10 (meters) - that doesn't mean other sizes won't work, but for those sizes, the simulation will generally work most reliably. This hint is taken from the <a href="http://box2d.org/">Box2D</a> manual.
</p>
<p>
The physics are <b>inaccurate</b>, since they are game-oriented (that means mainly fast and for realtime use) and not for accurate calculations. The idea is that they can deal with a lot of objects and situations in realtime, not an accurate representation of real world physics.
</p>
<p>For example, if you simply let an object fall down and calculate how fast it should fall to the ground and then compare with this simulation, you will see the result is most likely different. However, if you throw 20 boxes at each other, you will notice these physics can still deal with this in realtime and give you a convincing behaviour.
</p>
<p>To start, you will want to use <a href="#blitwiz.physics.createMovableObject">blitwiz.physics.createMovableObject</a> to create moving physics objects, and <a href="#blitwiz.physics.createObject">blitwiz.physics.createStaticObject</a> to create the static level geometry.
</p>
<ul>

<li><h2><a name="blitwiz.physics.createMovableObject">blitwiz.physics.createMovableObject()</a></h2>
<p>
Create a movable physics object. Movable means that apart from manual explicit position changes through <a href="#blitwiz.physics.warp">blitwiz.physics.warp</a>, the object can move by gravity forces, collisions etc. unlike static geometry created with <a href="#blitwiz.physics.createStaticObject">blitwiz.physics.createStaticObject</a> which has infinite mass and can never move on its own (you can still warp it around however).
</p>
<p>Movable objects can only have certain more simple geometry forms, which is why they aren't really suitable for the complex shape level geometry often has. Also, using static objects even with simple shapes (where a movable object could be used) simply saves a lot of calculation time. And maybe you just don't want certain things like the ground to possibly move away :-)
</p>
<p>
Remember to use <a href="#blitwiz.physics.destroyObject">blitwiz.physics.destroyObject</a> when you no longer want to use an object.
</p>
<p>
You will want to take the following steps:
</p>
<ul style="list-style-type:disc">
<li>
Set a geometry shape with any of the blitwiz.physics.setShape* functions which support movable objects, e.g. <a href="#blitwiz.physics.setShapeRectangle">blitwiz.physics.setShapeRectangle</a>.
</li>
<li>
Set a non-zero mass with <a href="#blitwiz.physics.setMass">blitwiz.physics.setMass</a>. If you don't do this, the object will have an infinite mass and not move.
</li>
<li>
Use <a href="#blitwiz.physics.warp">blitwiz.physics.warp</a> to place the object at any desired starting position (Warning: if it intersects with other objects, weird things will happen. Try it out if you want to have some physics fun).
</li>
</ul>
<p>
Parameters: None
</p>
<p>
Return value: movable <a href="#physics_object">physics object</a>
</p>
<p>
Example:
</p>
<div class="code">-- Create a 1x1 box object (if you pick a meter -&gt; pixel factor of 30,
-- which would be a reasonable idea, you should represent it with a 30x30
-- sized image)

local pobject = <a href="#blitwiz.physics.createMovableObject">blitwiz.physics.createMovableObject</a>()
<a href="#blitwiz.physics.setShapeRectangle">blitwiz.physics.setShapeRectangle</a>(pobject, 1, 1)
<a href="#blitwiz.physics.setMass">blitwiz.physics.setMass</a>(pobject, 10) -- the mass of the object
<a href="#blitwiz.physics.warp">blitwiz.physics.warp</a>(pobject, 2, 2) -- warp to pixel position 60, 60 (pixel factor is 30)

-- The default gravity is always 0 (x coordinate), 9 (y coordinate, so downwards).
-- Use <a href="#blitwiz.physics.setWorldGravity">blitwiz.physics.setWorldGravity</a> to change it for all objects.
-- You can also use <a href="#blitwiz.physics.setGravity">blitwiz.physics.setGravity</a> to override it on a per-object basis.
-- (the object will ignore the world gravity setting as a consequence)

-- Now you simply need to use <a href="#blitwiz.physics.getPosition">blitwiz.physics.getPosition</a> inside <a href="#blitwiz.on_draw">blitwiz.on_draw</a> to query
-- the position, then draw a 30x30 box image at that position each frame
</div>
</li>

<li><h2><a name="blitwiz.physics.createStaticObject">blitwiz.physics.createStaticObject()</a></h2>
<p>Create a non-movable physics object. Please note those objects cannot move (except when <a href="#blitwiz.physics.warp">warped</a> around which ignores any sort of collisions) and are intended for static geometry with which the movable objects can collide. It can use also the more complex geometry shapes and the movable objects will collide accordingly.
</p>
<p>
Set a shape with any of the blitwiz.physics.setShape* functions and then warp it at the right place with <a href="#blitwiz.physics.warp">blitwiz.physics.warp</a>. Setting a mass won't work because static geometry is well, static, and therefore has infinite mass.
</p>
<p>
Remember to use <a href="#blitwiz.physics.destroyObject">blitwiz.physics.destroyObject</a> when you no longer want to use an object.
</p>
<p>
Parameters: None
</p>
<p>
Return value: static <a href="#physics_object">physics object</a>
</p>
<p>
Example:
</p>
<div class="code">-- Create some static level geometry. We will assume a meter -&gt; pixel factor of 30
local pixelpermeterfac = 30

local geometry = <a href="#blitwiz.physics.createStaticObject">blitwiz.physics.createStaticObject</a>()
-- We can supply any list of collision edges we want:
<a href="#blitwiz.physics.setShapeEdges">blitwiz.physics.setShapeEdges</a>(geometry, [
	[0/pixelpermeterfac, 0/pixelpermeterfac, 500/pixelpermeterfac, 250/pixelpermeterfac],
	[500/pixelpermeterfac, 250/pixelpermeterfac, 0/pixelpermeterfac, 500/pixelpermeterfac]
])
-- An edge consists of an array (table) containing four coordinates (two for start and end point each)
-- We supply the edge 0,0 -&gt; 500,250 (pixels), and 500,250 -&gt; 0,500.

-- Since the object is static, those edges will never move unless you <a href="#blitwiz.physics.warp">warp</a> the object around.
</div>
</li>

<li><h2><a name="blitwiz.physics.destroyObject">blitwiz.physics.destroyObject(physics object <a href="#physics_object"><i>(physics object)</i></a>)</a></h2>
<p>
The given physics object will be destroyed. All references to it become invalid and using them will throw an error. Use this function to remove physics objects you no longer need.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object to be destroyed</li>
</ul>
</li>

<li><h2><a name="blitwiz.physics.impulse">blitwiz.physics.impulse(physics object <a href="#physics_object"><i>(physics object)</i></a>, impulse source x <i>(number)</i>, impulse source y <i>(number)</i>, impulse force x <i>(number)</i>, impulse force y <i>(number)</i>)</a></h2>
<p>
Apply a force impulse onto a movable physics object. You can think of it as a "push" applied onto the object that allows you to push it around. You can NOT directly control the results similarly to real life - the object will simply get pushed and will react according to the physics simulation, rotate, wobble, dance, whatever might be the result.
</p>
<p>
If you need to move an object to a point and require it to get there, then you should <a href="#blitwiz.physics.warp">warp</a> it - however forcing it into a position in such a way will ignore collision. If you want collision to be considered, you need to impulse it, however then you have no guarantee it actually moves as intended.
</p>
<p>
For player characters which you want to move around as intended to make them walk but where you still want collision taken into account, you should use this impulse function but restrict rotation with <a href="#blitwiz.physics.restrictRotation">blitwiz.physics.restrictRotation</a> so the player cannot randomly "fall over".
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object to which you want to apply an impulse
</li>
<li>
impulse source x <i>(number)</i> &mdash; the x source coordinate from where the impulse originates
</li>
<li>
impulse source y <i>(number)</i> &mdash; the y source coordinate
</li>
<li>
impulse force x <i>(number)</i> &mdash; the x coordinate of the direction and strength vector of the force. If in doubt, simply have the vector point directly onto your object, so that a force from your impulse source will directly slam into the object (see example)
</li>
<li>
impulse force y <i>(number)</i> &mdash; the y coordinate of the direction and strength vector
</li>
</ul>
<p>
Return value: None
</p>
<p>
Example:
</p>
<div class="code">-- Apply an impulse coming from the left into the center of an object
local x,y = <a href="#blitwiz.physics.setPosition">blitwiz.physics.setPosition</a>(object)
<a href="#blitwiz.physics.impulse">blitwiz.physics.impulse</a>(object, x - 5, y, 5, 0)

-- The direction 5, 0 basically points from the source x - 5, y into the center of the object (to the right).
-- The strength of the force impulse is the length of the force direction vector, so 5 in this case.
</div>
</li>

<li><h2><a name="blitwiz.physics.ray">blitwiz.physics.ray</a>(source x <i>(number)</i>, sourcey <i>(number)</i>, target x <i>(number)</i>, target y <i>(number)</i>)</h2>
<p>Cast a collision test ray from the source physics coordinates to the target coordinates to check if it hits a physics object. If an object is hit, you will get impact information. Please note this doesn't do anything to the target object, it is a purely informational collision check function. Returns nil if nothing was hit, otherwise the object that was hit, the impact position and normal.</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
source x <i>(number)</i> &mdash; source x coordinate for the ray's originating source position
</li>
<li>
source y <i>(number</i> &mdash; source y coordinate
</li>
<li>
target x <i>(number)</i> &mdash; target x coordinate for the ray's target
</li>
<li>
target y <i>(number)</i> &mdash; target y coordinate
</li>
</ul>
<p>Return value: either nil (when nothing was hit), or: hit object <a href="#physics_object"><i>(physics object)</i></a>, impact position x <i>(number)</i>, impact position y <i>(number)</i>, impact surface normal x <i>(number)</i>, impact surface normal y <i>(number)</i></p>
</li>

<li><h2><a name="blitwiz.physics.restrictRotation">blitwiz.physics.restrictRotation</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, restrict <i>(boolean)</i>)</h2>
<p>
Restrict rotation of the given object to the current angle. If you didn't just create the object (in which case the angle will be simply 0) you should warp it to a desired angle first.
</p>
<p>
This is mainly useful when you want an object that can move around and collide, but not fall over/rotate, e.g. a player character for which you would most likely want an oval or rectangle shape that doesn't fall over.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which to apply/change the shape
</li>
<li>
restrict <i>(boolean)</i> &mdash; a boolean whether you want to restrict it from now on (true) or not (false)
</li>
</ul>
<p>
Return value: None
</p>
</li>


<li><h2><a name="blitwiz.physics.setAngularDamping">blitwiz.physics.setAngularDamping</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, damping <i>(number)</i>)</h2>
<p>
Set the angular damping of the object which is always applied when the object rotates. With no angular damping, an object can rotate forever when once set in motion without ever stopping. When the angular damping is greater than zero, it will slow down the rotation accordingly. The default angular damping of objects is 0 (none).
</p>
<p>This can probably compared best to air friction.</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which you want to change the damping
</li>
<li>
damping <i>(number)</i> &mdash; the angular damping you want to set which should be in the range 0 (no damping) to infinity (full damping) - however, recommended values are between 0 and 0.1
</li>
</ul>
<p>
Return value: None
</p>
<li>

<li><h2><a name="blitwiz.physics.setFriction">blitwiz.physics.setFriction</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, friction <i>(number)</i>, mass center x offset <i>(number)</i>, mass center y offset <i>(number)</i>)</h2>
<p>
Set the friction of the physics object which is applied when it touches/collides with other objects. All objects with no friction set have 0 as default (no friction).
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which you want to change the friction
</li>
<li>
friction <i>(number)</i> &mdash; the friction you want to set which should be in the range 0 (no friction) to 1 (full friction)
</li>
</ul>
<p>
Return value: None
</p>
<li>

<li><h2><a name="blitwiz.physics.setGravity">blitwiz.physics.setGravity</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, x gravity force <i>(number)</i>, y gravity force <i>(number)</i>)</h2>
<p>
Set the gravity force which applies to a particular movable object. This means the world gravity set through <a href="#blitwiz.physics.setWorldGravity">blitwiz.physics.setWorldGravity</a> will be ignored by this object.
</p>
<p>
Use setGravity with just the object as parameter (without the gravity x/y force parameters) to reset the object to world gravity.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object to which apply a dedicated gravity force
<li>
x gravity force <i>(number)</i> &mdash; the x coordinate of the object's gravity force
</li>
<li>
y gravity force <i>(number)</i> &mdash; the y coordinate of the force
</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.physics.setLinearDamping">blitwiz.physics.setLinearDamping</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, damping <i>(number)</i>)</h2>
<p>
Set the linear damping of the object which is always applied when the object moves. With no linear damping, an object can move forever when once set in motion without ever stopping. When the linear damping is greater than zero, it will slow down the movement accordingly. The default linear damping of objects is 0 (none).
</p>
<p>This can probably compared best to air friction.</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which you want to change the damping
</li>
<li>
damping <i>(number)</i> &mdash; the linear damping you want to set which should be in the range 0 (no damping) to infinity (full damping) - however, recommended values are between 0 and 0.1
</li>
</ul>
<p>
Return value: None
</p>
<li>

<li><h2><a name="blitwiz.physics.setMass">blitwiz.physics.setMass</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, mass <i>(number)</i>, mass center x offset <i>(number)</i>, mass center y offset <i>(number)</i>)</h2>
<p>
Set the mass of a movable physics object (and optionally the mass center). It is intended to be in kilogram, but since the physics are a game-oriented (that means not a perfectly accurate) simulation it is recommended you simply experiment with values that suit you best. 0 is infinite mass. Please note that objects with a really huge mass can cause the physics to become unstable.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which you want to change the mass settings
</li>
<li>
mass <i>(number)</i> &mdash; the mass you want to set. 0 is infinite, negative masses are not allowed
</li>
<li>
mass center x coordinate <i>(number, optional)</i> &mdash; the x coordinate of the mass center. If not supplied, this will default to the center of the shape chosen (average of all shape coordinates for non-symmetric shapes like the polygon)
</li>
<li>
mass center y coordinate <i>(number, optional)</i> &mdash; the y coordinate of the mass center
</li>
</ul>
<p>
Return value: None
</p>
<li>

<li><h2><a name="blitwiz.physics.setRestitution">blitwiz.physics.setRestitution(physics object <a href="#physics_object"><i>(physics object)</i></a>, restitution <i>(number)</i>)</a></h2>
<p>
Set how much an object restitutes velocity after an impact. A restitution of 0 will make it stop fully at collision (default), and with 1 it will fully conserve all speed and bounce around.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which to change restitution
</li>
<li>
restitution <i>(number)</i> &mdash; the restitution in a range from 0 to 1
</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.physics.setShapeCircle">blitwiz.physics.setShapeCircle(physics object <a href="#physics_object"><i>(physics object)</i></a>, radius <i>(number)</i>)</a></h2>
<p>
Set a circle shape for an object. Compatible with both movable and static objects. Remember you shouldn't supply pixel values but a custom meter-similar physics unit. The shape will be used as a collision shape when calculating collisions.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which to apply/change the shape
</li>
<li>
radius <i>(number)</i> &mdash; the circle radius in physics units
</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.physics.setShapeEdges">blitwiz.physics.setShapeEdges</a>(physics object <a href="#physics_object"><i>(physics object)</i></a>, edge list <i>(table)</i>)</h2>
<p>
Set edges as collision shape for an object. Only compatible with static objects. Remember you shouldn't supply pixel values but a custom meter-similar physics unit. Please note the edges have an infinite thinness, so if you construct an enclosed shape with them (e.g. a square) it will be hollow inside and you can put things into it.
</p>
<p>It is mainly intended for use with static surrounding level walls. You can dump your whole level edges into one object, or use multiple objects.</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which to apply/change the shape
</li>
<li>
edge list <i>(table)</i> &mdash; a table/array that contains all edges. Each edge is an own table that contains 4 numbers - x/y coordinate of the edge's starting point, and x/y coordinate of the edge's end point. It is NOT required each edge is connected to the other
</li>
</ul>
<p>
Return value: None
</p>
<p>
Example:
</p>
<div class="code">-- Set a 0,100-500,100 pixel edge and a 0,400-500,400 pixel edge (not connected to each other), assuming 30 pixels per meter
local pixelpermeterfac = 30
<a href="#blitwiz.physics.setShapeEdges">blitwiz.physics.setShapeEdges</a>(object, [
	[0/pixelpermeterfac, 100/pixelpermeterfac, 500/pixelpermeterfac, 100/pixelpermeterfac],
	[0/pixelpermeterfac, 400/pixelpermeterfac, 500/pixelpermeterfac, 400/pixelpermeterfac],
])
</div>
</li>


<li><h2><a name="blitwiz.physics.setShapeOval">blitwiz.physics.setShapeOval(physics object <a href="#physics_object"><i>(physics object)</i></a>, oval width <i>(number)</i>, oval height <i>(number)</i>)</a></h2>
<p>
Set an oval shape for an object. Compatible with both movable and static objects. Remember you shouldn't supply pixel values but a custom meter-similar physics unit. The shape will be used as a collision shape when calculating collisions.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which to apply/change the shape
</li>
<li>
oval width <i>(number)</i> &mdash; horizontal size of the oval shape in physics units
</li>
<li>
oval height <i>(number)</i> &mdash; vertical size of the oval shape
</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.physics.setShapeRectangle">blitwiz.physics.setShapeRectangle(physics object <a href="#physics_object"><i>(physics object)</i></a>, rectangle width <i>(number)</i>, rectangle height <i>(number)</i>)</a></h2>
<p>
Set a rectangle shape for an object. Compatible with both movable and static objects. Remember you shouldn't supply pixel values but a custom meter-similar physics unit. The shape will be used as a collision shape when calculating collisions.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object for which to apply/change the shape
</li>
<li>
rectangle width <i>(number)</i> &mdash; the width in physics units of the rectangle
</li>
<li>
rectangle height <i>(number)</i> &mdash; the height of the rectangle
</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.physics.setWorldGravity">blitwiz.physics.setWorldGravity</a>(world x gravity force <i>(number)</i>, world y gravity force <i>(number)</i>)</h2>
<p>
Set the world gravity force which applies to all movable objects for which a dedicated gravity force isn't set.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>
world x gravity force <i>(number)</i> &mdash; the x coordinate of the world gravity force
</li>
<li>
world y gravity force <i>(number)</i> &mdash; the y coordinate of the force
</li>
</ul>
<p>
Return value: None
</p>
</li>

<li><h2><a name="blitwiz.physics.warp">blitwiz.physics.warp(physics object <a href="#physics_object"><i>(physics object)</i></a>, x position <i>(integer)</i>, y position <i>(integer)</i>, rotation angle <i>(number)</i>)</a></h2>
<p>
The given physics object will be warped to the given position and rotation. Please note warping is an instant teleportation and ignores all collisions. Warping fully or partially into other objects is possible aswell and can lead to strange physics results. You should use warping only rarely e.g. to setup objects to their intended initial positions in the game world.
</p>
<p>
Please remember (see the introduction text to this chapter) that you shouldn't use pixel units, but rather a custom unit that maps roughly to meters in the real world in terms of average objects scale.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>physics object <a href="#physics_object"><i>(physics object)</i></a> &mdash; the physics object to be warped</li>
<li>x position <i>(number)</i> &mdash; the x coordinate of the position where you want to warp the object to</li>
<li>y position <i>(number)</i> &mdash; the y coordinate of the warp position</li>
<li>rotation angle <i>(number)</i> &mdash; the angle for the rotation. 90 is 90° clockwise, -90 is 90° ocounter-clockwise etc.</li>
</ul>
<p>
Return value: None
</p>
</li>

</ul>
<a name="blitwiz.sound"><h1>7. <i>blitwiz.sound</i> namespace</h1></a>
<ul>

<li><h2><a name="blitwiz.sound.adjust">blitwiz.sound.adjust</a>(sound <a href="#sound_handle"><i>(sound handle)</i></a>, volume <i>(number)</i>, panning <i>(number)</i>)</h2>
<p>Adjust the parameters of a playing sound: You can change the volume and the panning (stereo placement). Does nothing if the sound is no longer playing.</p>
<p>Parameters:
</p>
<ul>
<li>sound <a href="#sound_handle"><i>(sound handle)</i></a> &mdash; the sound for which the parameters should be adjusted</li>
<li>volume <i>(number)</i> &mdash; the volume, specified in a range from 0 (quiet) to 1 (full volume)</li>
<li>panning <i>(number)</i> &mdash; panning for the sound in a range from 1 (left) to -1 (right)</li>
</ul>
<p>Return value: None</p>
</li>

<li><h2><a name="blitwiz.sound.getBackendName">blitwiz.sound.getBackendName</a>()</h2>
<p>
Get the name of the currently active audio backend, which can be e.g. "directsound" or "waveout" on Windows, "alsa" or "oss" on Linux, or "coreaudio" for Mac.
</p>
<p>Parameters: None</p>
<p>Return value: backend name <i>(string)</i></p>
</li>

<li><h2><a name="blitwiz.sound.play">blitwiz.sound.play</a>(path <i>(string)</i>, volume <i>(number)</i>, panning <i>(number)</i>, loop <i>(boolean)</i>, priority <i>(number)</i>, fadein <i>(number)</i>)</h2>
<p>
Play the sound file found at the given path. The sound will be decoded and read on-the-fly,
so this function usually causes no load delay.
</p>
<p>
Currently supported audio file formats:
</p>
<ul>
<li>.ogg <small>(natively/always)</small>, </li>
<li>
mp3, .wav, .aac, .flac, .mp4 &mdash; <i>and many more...</i> <small>(only when <a href="http://ffmpeg.org/">FFmpeg</a> is available, see blitwizard's README.txt's note on audio)</small>
</li>
</ul>
<p>If a sound fails to play because the file on disk cannot be opened/read, it will throw an error. If a sound fails to play because all slots are used by higher priority sounds (see remark on the priority parameter below), it will return a sound handle without error but simply not play the sound.
</p>
<p>When the audio format isn't known or the audio file is corrupt and cannot be played, an error will be thrown aswell. If you cannot play any other formats than .ogg files correctly, please check on FFmpeg (see supported audio file formats above).
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>path <i>(string)</i> &mdash; the path to the audio file</li>
<li>volume <i>(number, optional)</i> &mdash; volume from 0 (silent) to 1 (full volume), default is 1</li>
<li>panning <i>(number, optional)</i> &mdash; stereo panning from 1 (left) to -1 (right), default is 0 (center)</li>
<li>loop <i>(boolean, optional)</i> &mdash; specify whether the sound should be looped forever with true, or just played once with false. default is false</li>
<li>priority <i>(number, optional)</i> &mdash; specify the priority of a sound. The amount of sounds that can play at once is limited, and a higher priority sound will always kill a lower priority sound to gain a slot. A lower priority sound might not be played at all if all slots are occupied with higher priority sounds. Using high priority for music is suggested. The priority is a positive number starting from 0 upwards (higher number is higher priority). If you specify no priority (default), the sound is even less priority than a sound with any specified priority</li>
<li>fadein <i>(number, optional)</i> &mdash; the amount of seconds to use for a fadein effect. E.g. specify 1.5 to fade in from silent to the specified volume in 1.5 seconds. Default: 0 (instant full volume)</li>
</ul>
<p>
Return values: sound handle <i>(<a href="#sound_handle">sound handle</a>)</i>
</p>
<p>
Examples:
</p>
<div class="code">-- Simply play a sound:
blitwiz.sound.play("buzz.ogg")
</div>
&nbsp;
<div class="code">-- Play a long ambient sound at 50% volume with 50% panning to the right, looping forever:
blitwiz.sound.play("ambient.ogg", 0.5, -0.5, true)
</div>
&nbsp;
<div class="code">-- Play a music track at 80% volume, looping forever with high priority
blitwiz.sound.play("music.ogg", 0.8, 0, true, 50)
</div>
</li>

<li><h2><a name="blitwiz.sound.playing">blitwiz.sound.playing</a>(sound <a href="#sound_handle"><i>(sound handle)</i></a>)</h2>
<p>Check if a sound is still playing. Returns true if it is, otherwise false.</p>
<p>Parameters:
</p>
<ul>
<li>sound <a href="#sound_handle"><i>(sound handle)</i></a> &mdash; the sound which should be checked</li>
</ul>
<p>Return value: play state of sound <i>(boolean)</i></p>
</p>

<li><h2><a name="blitwiz.sound.stop">blitwiz.sound.stop</a>(sound <a href="#sound_handle"><i>(sound handle)</i></a>)</h2>
<p>Stop a playing sound. Does nothing if the sound has already stopped.</p>
<p>Parameters:
<ul>
<li>sound <a href="#sound_handle"><i>(sound handle)</i></a> &mdash; the sound which should be stopped</li>
</ul>
<p>Return value: None</p>
</li>

</ul>
<a name="blitwiz.time"><h1>8. <i>blitwiz.time</i> namespace</h1></a>
<ul>

<li><h2><a name="blitwiz.time.getTime">blitwiz.time.getTime()</a></h2>
<p>
Return the elapsed time in milliseconds from a fixed point in time (which might be application start or anything else) which blitwizard chooses at application start. If you call this function multiple times and then check the difference between the values it gave you, this difference will represent the elapsed time between the calls in milliseconds.
</p>
<p>
Parameters: None
</p>
<p>Return value: the time elapsed in milliseconds since an unspecified fixed point in time <i>(number)</i></p>
</li>

<li><h2><a name="blitwiz.time.sleep">blitwiz.time.sleep(milliseconds <i>(number)</i>)</a></h2>
<p>
Stop the execution of the whole program for the specified amount of time. This function will block until the given amount of time has passed, and then return and allow your program to continue.
</p>
<p>During the blocking of this function, no drawing or event or physics processing will be done. However, sound will continue to play. Please note physics and game logic (on_step) will attempt to catch up for the missed time, so blocking your program for multiple seconds might be a bad idea.</p>
<p>Therefore, the only senseful usage of this call is probably using it for small (20-200 milliseconds) sleeps to lower cpu usage.</p>
<p>Parameters:
</p>
<ul>
<li>milliseconds <i>(number)</i> &mdash; the amount of milliseconds you want execution to stop</li>
</ul>
<p>Return value: None</p>
</li>

</ul>
<a name="blitwiz.on_*"><h1>9. Event callbacks</h1></a>
<ul>

<li><h2><a name="blitwiz.on_close">blitwiz.on_close</a>()</h2>
<p>
If you define this function in your program in the global space,
it will be called when the user clicks the close button in the
title bar (in windowed mode).
</p>
<p>
If you don't do anything, the user will be unable to easily close
the window! Therefore, it is recommended you put this code into
your programs if you don't wish to add special confirmation questions
which should delay the termination progress:
</p>
<p>
Example:
</p>
<div class="code">function blitwiz.on_close()
	os.exit(0)
end
</div>
</li>

<li><h2><a name="blitwiz.on_draw">blitwiz.on_draw</a>()</h2>
<p>
If you define this function in your program in the global space, it will be called
each time blitwizard scheduled a redraw (this happens automatically many times in
a second, you don't have to do anything for it).
</p>
<p>Place all your <a href="#blitwiz.graphics.drawImage">blitwiz.graphics.drawImage</a>
calls into this function. Put any game logic and physics into
<a href="#blitwiz.on_step">on_step</a>.
</p>
</li>

<li><h2><a name="blitwiz.on_image">blitwiz.on_image</a>(texture name <i>(string)</i>, result <i>(boolean)</i>)</h2>
<p>
If you define this function in your program in the global space, it will be called
as soon as an image from a <a href="#blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>
has either finished loading and is now available for drawing
operations, or if an image has failed loading and won't be available at all.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>texture name <i>(string)</i> &mdash; contains the texture path (which was originally
provided to <a href="#blitwiz.graphics.loadImageAsync">blitwiz.graphics.loadImageAsync</a>)</li>
<li>result <i>(boolean)</i> &mdash; indicates whether the image has been successfully loaded (in which case
it will be true), or failed to load (in which case it will be false)</li>
</ul>
<p>
Example:
</p>
<div class="code">--Print out the loading result of any loaded image
function blitwiz.on_image(texture, result)
	if result == true then
		print ("Image " .. texure .. " has been loaded and is now available for drawing.")
	else
		print ("Image " .. texture .. " failed to load!")
	end
end
</div>
</li>

<li><h2><a name="blitwiz.on_init">blitwiz.on_init</a>()</h2>
<p>
This function is called once when blitwizard starts.
You should open a window here if you wish to do graphical things.
</p>
<p>
Please note when this functions returns without any window being open,
blitwizard quits (instead of calling
<a href="#blitwiz.on_step">on_step</a>
and
<a href="#blitwiz.on_draw">on_draw</a>
constantly and keeping your game running even if the window is later
temporarily closed).
This is done to support short Lua command line programs aswell.
</p>
<p>
Example:
</p>
<div class="code">function blitwiz.on_init()
	-- Open a window
	blitwiz.graphics.setWindow(400,300)
end
</div>
</li>

<li><h2><a name="blitwiz.on_keydown">blitwiz.on_keydown</a>(key <i>(string)</i>)</h2>
<h2><a name="blitwiz.on_keyup">blitwiz.on_keyup</a>(key <i>(string)</i>)</h2>
<p>
If you define those functions in your program in the global space, they
will be called when the user presses (on_keydown) or releases (on_keyup) a key.
</p>
<p>
Please note you should use those functions only for key bindings/action keys,
not to gather real text input. The reason is that on
non-English computers, multiple key presses might together generate another character
(one char through multiple key presses, not one char per key press) which this function
will not take into account. Use the <a href="#blitwiz.on_text">on_text</a> event for
multi-language text input support.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>key <i>(string)</i> &mdash; a string that describes the key. See <a href="keylist.html">the key list</a> for a complete list of supported keys</li>
</ul>
<p>
Example:
</p>
<div class="code">function blitwiz.on_keydown(key)
	if key == "escape" then
		-- Quit the program
		os.exit(0)
	end
end
</div>
</li>

<li><h2><a name="blitwiz.on_mousedown">blitwiz.on_mousedown</a>(button <i>(number)</i>, x <i>(number)</i>, y <i>(number)</i>)</h2>
<h2><a name="blitwiz.on_mouseup">blitwiz.on_mouseup</a>(button <i>(number)</i>, x <i>(number)</i>, y <i>(number)</i>)</h2>
<p>
If you define those functions in your program in the global space, they
will be called when the user presses (on_mousedown) or releases (on_mouseup)
a mouse button.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>button <i>(number)</i> &mdash; the mouse button pressed or released, 1 for left, 2 for right, 3 for middle, 4...</li>
<li>x <i>(number)</i> &mdash; the mouse position's x coordinate where the action was triggered</li>
<li>y <i>(number)</i> &mdash; the mouse position's y</li>
</ul>
<p>
Example:
</p>
<div class="code">--Terminate the program when the user clicks the upper left corner of the drawing area:
function blitwiz.on_mousedown(button, x, y)
	if x &lt; 50 and y &lt; 50 then
		-- Quit the program
		os.exit(0)
	end
end
</div>
</li>

<li><h2><a name="blitwiz.on_mousemove">blitwiz.on_mousemove</a>(x <i>(number)</i>, y <i>(number)</i>)</h2>
<p>
If you define this function in your program in the global space,
it will be called when the mouse is moved over the drawing area of the window.
Mouse movements outside of the window are not detected.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>x <i>(number)</i> &mdash; the mouse position's x coordinate where the action was triggered</li>
<li>y <i>(number)</i> &mdash; the mouse position's y</li>
</ul>
</li>

<li><h2><a name="blitwiz.on_step">blitwiz.on_step</a>()</h2>
<p>
This function is called constantly every 16ms (that is 62.5 times a second).
While blitwizard cannot guarantee that this amount of time is exactly met
each cycle, it will guarantee this amount of time is met on average (so up
to a larger span like one second, those amount of cycles is pretty much set
in stone).
</p>
<p>
In this function, you should do all game logic (like calculating speed,
movement, new positions), not any drawing. Due to the guaranteed constantness,
you will not need to do any sort of time measurement and adaption for the
<a href="http://en.wikipedia.org/wiki/Frame_rate">FPS</a>
of the game for yourself - the fixed call interval of
<a href="#blitwiz.on_step">on_step</a> will make this completely
unnecessary.
</p>
<p>
Drawing, which needs more processing time than the logic usually,
happens independently in <a href="#blitwiz.on_draw">on_draw</a> and
is subject to the usual fluctuations in speed and still highly depends
on the machine the game runs on for its varying interval.
</p>
<p>
Please note that there is one little exception to the constantness: If you do
very computationally extensive activies like pathfinding, moving massive amount
of enemies or blocking activies like file disk access, you will indeed break
the constant interval calls.
</p>
<p>Doing this rarely (e.g. with a file disk access
for loading something at loading screen time) is no problem, but if you exceed
your time constantly, the game will simply lag as hell :-) so while this problem
should be usually no issue to be avoided if you take a bit care of what and how
much you're doing, you should keep this limitation in mind.
</p>
<p>
Example:
</p>
<div class="code">--Terminate the program when the user clicks the upper left corner of the drawing area:
function blitwiz.on_mousedown(button, x, y)
	if x &lt; 50 and y &lt; 50 then
		-- Quit the program
		os.exit(0)
	end
end
</div>
</li>

<li><h2><a name="blitwiz.on_text">blitwiz.on_text</a>(text <i>(string)</i>)</h2>
<p>
If you define this function in your program in the global space,
it will be called anytime the user enters text (in parallel to the
<a href="#blitwiz.on_keydown">on_keydown</a> and <a href="#blitwiz.on_keyup">on_keyup</a>
events).
</p>
<p>Unlike the on_keydown/on_keyup events however, the text
input event processes all key press combinations even on foreign
language keyboards properly to generate according Utf-8 output
with any sort of characters that might be entered in any supported
language.
This is accomplished using the advanced Utf-8 processing of the
<a href="http://libsdl.org/">SDL library</a>.
</p>
<p>Please note you still need to take care of actually rendering
those Utf-8 strings yourself for good foreign language support,
since the <a href="templates/font/api.html">font renderer template</a>
cannot exactly process much.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>text <i>(string)</i> &mdash; the new letter of group of letters entered, Utf-8 encoded for non-ASCII letters</li>
</ul>
</li>

</ul>

<a name="10os"><h1>10. <i>os</i> standard namespace extension</h1></a>
<p>This describes the blitwizard extensions to the Lua standard <b>os</b> library. Check the manual on <a href="http://www.lua.org/">www.lua.org</a> for the standard functions of the os lib already provided by Lua.</p>
<ul>

<li><h2><a name="os.chdir">os.chdir</a>(path <i>(string)</i>)</h2>
<p>
Change the Current Working Directory to the given path.
The path can be a relative path to the current working dir,
or an absolute folder path.
</p>
<p>
The target must be a folder obviously. If changing the directory
fails (e.g. due to insufficient privilegues), an error is thrown.
</p>
<p>
<b>Important:</b>
You should use / as a cross-platform folder delimeter in blitwizard,
NOT \ which is only safe on Windows:
</p>
<div style="font-style:italic">Correct:</div>
<div class="code">folder/subfolder/
C:/testfolder/
</div>
<div style="font-style:italic">Wrong:</div>
<div class="code">C:\testfolder\
</div>
<p>
Parameters:
</p>
<ul class="parameters">
<li>path <i>(string)</i> &mdash; the path to change the current working directory to</li>
</ul>
</li>

<li><h2><a name="os.exists">os.exists</a>(path <i>(string)</i>)</h2>
<p>
Check whether a given path leads to some actual place (directory, file, ...).
</p>
<p>
<b>Important:</b>
You should use / as a cross-platform folder delimeter in blitwizard,
NOT \ which is only safe on Windows:
</p>
<div style="font-style:italic">Correct:</div>
<div class="code">folder/subfolder/
C:/testfolder/
</div>
<div style="font-style:italic">Wrong:</div>
<div class="code">C:\testfolder\
</div>
<p>
Parameters:
</p>
<ul class="parameters">
<li>path <i>(string)</i> &mdash; the path to check for existance</li>
</ul>
<p>
Return value: <i>(boolean)</i> target exists (true) or doesn't (false)
</p>
</li>

<li><h2><a name="os.ls">os.isdir</a>(path <i>(string)</i>)</h2>
<p>
Check whether a given path is a directory or a folder. Throws an error if the path doesn't lead to any valid place (you can check that with <a href="#os.exists">os.exists</a> beforehand if you want to).
</p>
<p>
<b>Important:</b>
You should use / as a cross-platform folder delimeter in blitwizard,
NOT \ which is only safe on Windows:
</p>
<div style="font-style:italic">Correct:</div>
<div class="code">folder/subfolder/
C:/testfolder/
</div>
<div style="font-style:italic">Wrong:</div>
<div class="code">C:\testfolder\
</div>
<p>
Parameters:
</p>
<ul class="parameters">
<li>path <i>(string)</i> &mdash; the path to check for being a directory or not</li>
</ul>
<p>
Return value: <i>(boolean)</i> directory (true) or not (false)
</p>
</li>

<li><h2><a name="os.getcwd">os.getcwd</a>()</h2>
<p>
Obtains the current working directory.
</p>
<p>
Paramaters: None
</p>
<p>
Return value: current working directory <i>(string)</i>
</p>
<p>Examples:
</p>
<div class="code">print ("Current working directory is: " .. os.cwd())</div>
</li>

<li><h2><a name="os.ls">os.ls</a>(path <i>(string)</i>)</h2>
<p>
Return an array table listing the name of all items (subfolders and files) inside the given directory.
</p>
<p>
<b>Important:</b>
You should use / as a cross-platform folder delimeter in blitwizard,
NOT \ which is only safe on Windows:
</p>
<div style="font-style:italic">Correct:</div>
<div class="code">folder/subfolder/
C:/testfolder/
</div>
<div style="font-style:italic">Wrong:</div>
<div class="code">C:\testfolder\
</div>
<p>
Parameters:
</p>
<ul class="parameters">
<li>path <i>(string)</i> &mdash; the path to list all the contents from</li>
</ul>
<p>
Return value: <i>(table)</i> array of directory contents
</p>
<p>Example:
</p>
<div class="code">-- Print out the names of all files and directories inside the current working dir
local files = os.ls("")
for i,f in ipairs(files) do
	print ("File: " .. f)
end
</div>
</li>

<li><h2><a name="os.openConsole">os.openConsole</a>()</h2>
<p>
On a Windows platform, open a console window since blitwizard will
otherwise run without console.
stdout will then go to that console window which can
help if you need to have an easily usable console window for debug output.
Most other platforms (notably Linux, Mac) allow running blitwizard with
working stdout console output anyway, so this call is not required (and will
simply do nothing on those platforms).
</p>
<p>
Paramaters: None
</p>
<p>
Return value: None
</p>
<p>Examples:</p>
<div class="code">os.openConsole()</div>
</li>

<li><h2><a name="os.sysname">os.sysname</a>()</h2>
<p>
Return a string representing the system name.
</p>
<p>
Parameters: None
</p>
<p>
Return value: <i>(string)</i> the system name. Examples: "Windows", "Linux", "Android", "Mac OS X", "FreeBSD", "OpenBSD", ...
</p>
</li>

<li><h2><a name="os.sysversion">os.sysversion</a>()</h2>
<p>
Return a string representing the system version.
</p>
<p>
Parameters: None
</p>
<p>
Return value: <i>(string)</i> the system version.
</p>
</li>

</ul>
<a name="string"><h1>11. <i>string</i> standard namespace extension</h1></a>
<p>This describes the blitwizard extensions to the Lua standard <b>string</b> library. Check the manual on <a href="http://www.lua.org/">www.lua.org</a> for the standard functions of the string lib already provided by Lua.</p>
<ul>

<li><h2><a name="string.ends">string.ends</a>(str1 <i>(string)</i>, str2 <i>(string)</i>)</h2>
<p>
Check if str1 ends with str2 (so str1 has at least the length of str2, and cropping it from the beginning to the length of str2 would make them equal). Returns true if that is the case, otherwise false.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>str1 <i>(string)</i> &mdash; the string which should be tested for str2</li>
<li>str2 <i>(string)</i> &mdash; the string with which str2 possibly ends</li>
</ul>
<p>
Return value: <i>(boolean)</i> result of the check
</p>
</li>

<li><h2><a name="string.split">string.split</a>(expression <i>(string)</i>, delimeter <i>(string)</i>, limit <i>(number)</i>)</h2>
<p>
Search occurances of the delimeter in the given expression, and split it up around each delimeter that is found and return the separated results (check the example code below).</p>
<p>The limit allows to specify a limit after which splitting will be stopped even if more delimeter occurances could be found.</p>
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>str1 <i>(string)</i> &mdash; the string which should be tested for str2</li>
<li>str2 <i>(string)</i> &mdash; the string with which str2 possibly begins</li>
</ul>
<p>
Return value: <i>(string, multiple)</i> all the resulting strings of the split
</p>
<p>Examples:
</p>
<div class="code">local a,b = string.split("a|b", "|")
print(a .. ", " .. b)  -- outputs: a, b

local count = #{string.split("this, is, a, list, of, things", ",")}
print(count)  -- outputs: 6

local a,b,c = string.split("c|d|e", "|", 1)
print(a)  -- outputs: c
print(b)  -- outputs: d|e
print(c)  -- outputs: no value (nil)</div>
</li>

<li><h2><a name="string.starts">string.starts</a>(str1 <i>(string)</i>, str2 <i>(string)</i>)</h2>
<p>
Check if str1 begins with str2 (so str1 has at least the length of str2, and cropping it from the end to the length of str2 would make them equal). Returns true if that is the case, otherwise false.
</p>
<p>
Parameters:
</p>
<ul class="parameters">
<li>str1 <i>(string)</i> &mdash; the string which should be tested for str2</li>
<li>str2 <i>(string)</i> &mdash; the string with which str2 possibly begins</li>
</ul>
<p>
Return value: <i>(boolean)</i> result of the check
</p>
</li>

</ul>
</body>
</html>
